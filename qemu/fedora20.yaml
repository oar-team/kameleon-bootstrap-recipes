#==============================================================================
# vim: softtabstop=2 shiftwidth=2 expandtab fenc=utf-8 cc=81 tw=80
#==============================================================================
#
# DESCRIPTION: Fedora 20 base system built with qemu-kvm.
#
#==============================================================================
---
extend: base.yaml

# Global variables use by Kameleon engine and the steps
global:
  # Distribution
  distrib: fedora
  release: 20

  ## System variables. Required by kameleon engine
  # Include specific steps
  include_steps:
    - $$distrib/$$release
    - $$distrib
    - "centos"

  bootstrap_requirements: parted e2fsprogs yum rpm lynx extlinux curl

  bootstrap_packages: findutils util-linux net-tools dhclient openssh-server

  setup_packages: kernel dracut dracut-kernel

  mirror_url: http://archives.fedoraproject.org/pub/archive/fedora/linux/releases/$$release/Fedora/$$arch

  release_packages: fedora-release-$$release

# Bootstrap the new system and create the 'in_context'
bootstrap:
  - "@base"
  - yum_bootstrap:
    - mirror_packages_url: $$mirror_url/os/Packages/f/
    - release_packages: $$release_packages
    - include_pkgs: yum $$bootstrap_packages
  - init_pxeboot:
    - pxe_initrd_url: $$mirror_url/os/images/pxeboot/initrd.img
    - pxe_vmlinuz_url: $$mirror_url/os/images/pxeboot/vmlinuz
  - reboot_qemu

# Install and configuration steps
setup:
  - "@base"

# Export the generated appliance in the format of your choice
export:
  - "@base"
